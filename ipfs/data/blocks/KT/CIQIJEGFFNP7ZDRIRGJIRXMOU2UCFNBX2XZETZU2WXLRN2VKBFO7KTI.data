
ÃŠ¹Š(window.webpackJsonp=window.webpackJsonp||[]).push([[91],{628:function(t,s,e){"use strict";e.r(s);var a=e(24),r=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"server-infrastructure"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#server-infrastructure"}},[t._v("#")]),t._v(" Server infrastructure")]),t._v(" "),e("p",[t._v("If you want to install IPFS in a server environment and offer IPFS as a service, you should look at IPFS Cluster. IPFS Cluster provides data orchestration across a swarm of IPFS daemons by allocating, replicating, and tracking a global pin-set distributed among multiple peers. This makes it significantly easier to manage multiple IPFS nodes and ensure that data is available across an internal network.")]),t._v(" "),e("h2",{attrs:{id:"create-a-local-cluster"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#create-a-local-cluster"}},[t._v("#")]),t._v(" Create a local cluster")]),t._v(" "),e("p",[t._v("To see if IPFS Cluster is suitable for your project, follow this quick start guide and spin up a local IPFS Cluster instance. At the end of this guide, you will have a solid understanding of how IPFS Cluster is set up and how to interact with it. If you'd rather create a production-ready cluster, take a look at the "),e("a",{attrs:{href:"https://cluster.ipfs.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("official IPFS Cluster documentation â†’"),e("OutboundLink")],1)]),t._v(" "),e("h3",{attrs:{id:"prerequisites"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#prerequisites"}},[t._v("#")]),t._v(" Prerequisites")]),t._v(" "),e("p",[t._v("You must have both "),e("a",{attrs:{href:"https://docs.docker.com/install/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Docker"),e("OutboundLink")],1),t._v(" and "),e("a",{attrs:{href:"https://docs.docker.com/compose/install/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Docker Compose"),e("OutboundLink")],1),t._v(" installed. Check that they're both installed properly by asking for their version:")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" version\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Client: Docker Engine - Community\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Version:           "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("19.03")]),t._v(".13\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" API version:       "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.40")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker-compose")]),t._v(" version\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker-compose")]),t._v(" version "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.27")]),t._v(".4, build "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("40524192")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" docker-py version: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("4.3")]),t._v(".1\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n")])])]),e("p",[t._v("If you're having issues here, head over to the "),e("a",{attrs:{href:"https://docs.docker.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("official Docker documentation to fix your problem â†’"),e("OutboundLink")],1)]),t._v(" "),e("h3",{attrs:{id:"steps"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#steps"}},[t._v("#")]),t._v(" Steps")]),t._v(" "),e("ol",[e("li",[e("p",[t._v("Download the latest "),e("code",[t._v("ipfs-cluster-ctl")]),t._v(" package from "),e("a",{attrs:{href:"https://dist.ipfs.io/#ipfs-cluster-ctl",target:"_blank",rel:"noopener noreferrer"}},[t._v("dist.ipfs.io"),e("OutboundLink")],1),t._v(":")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("wget")]),t._v(" https://dist.ipfs.io/ipfs-cluster-ctl/v0.14.0/ipfs-cluster-ctl_v0.14.0_linux-amd64.tar.gz\n")])])])]),t._v(" "),e("li",[e("p",[t._v("Unzip the package:")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("tar")]),t._v(" xvzf ipfs-cluster-ctl_v0.14.0_linux-amd64.tar.gz\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" ipfs-cluster-ctl/ipfs-cluster-ctl\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" ipfs-cluster-ctl/LICENSE\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" ipfs-cluster-ctl/LICENSE-APACHE\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" ipfs-cluster-ctl/LICENSE-MIT\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" ipfs-cluster-ctl/README.md\n")])])])]),t._v(" "),e("li",[e("p",[t._v("Download the "),e("a",{attrs:{href:"https://raw.githubusercontent.com/ipfs/ipfs-cluster/master/docker-compose.yml",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("docker-composer.yml")]),t._v(" file"),e("OutboundLink")],1),t._v(" and place it into the "),e("code",[t._v("ipfs-cluster-ctl")]),t._v(" directory:")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("wget")]),t._v(" https://raw.githubusercontent.com/ipfs/ipfs-cluster/master/docker-compose.yml\n")])])])]),t._v(" "),e("li",[e("p",[t._v("Start the cluster using "),e("code",[t._v("docker-compose")]),t._v(". You may have to run as root:")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker-compose")]),t._v(" up\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Recreating ipfs2 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("done")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Recreating ipfs1    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("done")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Recreating ipfs0    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("done")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Recreating cluster2 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("done")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n")])])])])]),t._v(" "),e("p",[t._v("You may see some errors like:")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[t._v('```shell\ncluster2    | 2020-10-27T15:20:15.116Z  ERROR   ipfshttp    error posting to IPFS:Post "http://172.18.0.2:5001/api/v0/pin/ls?type=recursive": dial tcp 172.18.0.2:5001: connect: connection refused\n```\n')])])]),e("p",[t._v("You can safely ignore these for now. They're showing because some of the IPFS nodes within the cluster haven't finished spinning up yet. Everything should have loaded after a couple of minutes:")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[t._v("```shell\n> ipfs1       | API server listening on /ip4/0.0.0.0/tcp/5001\n> ipfs1       | WebUI: http://0.0.0.0:5001/webui\n> ipfs1       | Gateway (readonly) server listening on /ip4/0.0.0.0/tcp/8080\n> ipfs1       | Daemon is ready\n```\n")])])]),e("ol",[e("li",[e("p",[t._v("You can now interact with your cluster. In a new terminal, navigate to the "),e("code",[t._v("ipfs-cluster-ctl")]),t._v(" directory and list the peers within the cluster:")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("./ipfs-cluster-ctl peers "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" 12D3KooWBaQ9SGtdnJmyS2fe7uq5gXQnejCf5ma2n9cUEbwVD5gf "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" cluster2 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Sees "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" other peers\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Addresses:\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" - /ip4/127.0.0.1/tcp/9096/p2p/12D3KooWBaQ9SGtdnJmyS2fe7uq5gXQnejCf5ma2n9cUEbwVD5gf\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" - /ip4/172.18.0.5/tcp/9096/p2p/12D3KooWBaQ9SGtdnJmyS2fe7uq5gXQnejCf5ma2n9cUEbwVD5gf\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" 12D3KooWDmjW55h3vSqLmSm1fBxPzs1dHkbtjWSHEj7RhzpcY9vE "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" cluster0 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Sees "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" other peers\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Addresses:\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" - /ip4/127.0.0.1/tcp/9096/p2p/12D3KooWDmjW55h3vSqLmSm1fBxPzs1dHkbtjWSHEj7RhzpcY9vE\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" - /ip4/172.18.0.7/tcp/9096/p2p/12D3KooWDmjW55h3vSqLmSm1fBxPzs1dHkbtjWSHEj7RhzpcY9vE\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" 12D3KooWLhGJaddVKj8gsYXfYpyMKL5NhcmtiakDCWhDGtZJSu2w "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" cluster1 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Sees "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" other peers\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Addresses:\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" - /ip4/127.0.0.1/tcp/9096/p2p/12D3KooWLhGJaddVKj8gsYXfYpyMKL5NhcmtiakDCWhDGtZJSu2w\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" - /ip4/172.18.0.6/tcp/9096/p2p/12D3KooWLhGJaddVKj8gsYXfYpyMKL5NhcmtiakDCWhDGtZJSu2w\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n")])])])]),t._v(" "),e("li",[e("p",[t._v("Add a file into the cluster:")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("wget")]),t._v(" https://upload.wikimedia.org/wikipedia/commons/6/63/Neptune_-_Voyager_2_%2829347980845%29_flatten_crop.jpg\n./ipfs-cluster-ctl "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" Neptune_-_Voyager_2_"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("29347980845")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("_flatten_crop.jpg\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" added QmdzvHZt6QRJzySuVzURUvKCUzrgGwksvrsnqTryqxD4yn Neptune_-_Voyager_2_"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("29347980845")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("_flatten_crop.jpg\n")])])])]),t._v(" "),e("li",[e("p",[t._v("See the status of that file across the cluster of IPFS nodes using the CID given above:")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("./ipfs-cluster-ctl status QmdzvHZt6QRJzySuVzURUvKCUzrgGwksvrsnqTryqxD4yn\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" QmdzvHZt6QRJzySuVzURUvKCUzrgGwksvrsnqTryqxD4yn:\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" cluster2             "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" PINNED "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v("-10-27T15:42:39.984850961Z\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" cluster0             "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" PINNED "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v("-10-27T15:42:39.984556496Z\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" cluster1             "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" PINNED "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v("-10-27T15:42:39.984842325Z\n")])])])])]),t._v(" "),e("p",[t._v("This shows us that "),e("code",[t._v("QmdzvHZ...")]),t._v(" is pinned across the three IPFS nodes within our cluster.")]),t._v(" "),e("ol",[e("li",[e("p",[t._v("When you're finished playing around, kill the cluster. You may have to run this as root:")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker-compose")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("kill")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Killing cluster0 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("done")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Killing cluster1 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("done")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Killing cluster2 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("done")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Killing ipfs1    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("done")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Killing ipfs0    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("done")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Killing ipfs2    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("done")]),t._v("\n")])])])])]),t._v(" "),e("p",[t._v("The terminal running the "),e("code",[t._v("ipfs-cluster-ctl")]),t._v(" daemon will close any open connections:")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[t._v("```shell\n> ...\n> ipfs0 exited with code 137\n> ipfs1 exited with code 137\n> cluster0 exited with code 137\n> cluster2 exited with code 137\n> cluster1 exited with code 137\n> ipfs2 exited with code 137\n```\n")])])]),e("h2",{attrs:{id:"next-steps"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#next-steps"}},[t._v("#")]),t._v(" Next steps")]),t._v(" "),e("p",[t._v("If you want to delve deeper into IPFS Cluster, check out the project's documentation at "),e("a",{attrs:{href:"https://cluster.ipfs.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("cluster.ipfs.io â†’"),e("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=r.exports}}]);¹Š