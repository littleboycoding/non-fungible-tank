
ç¹Ý¹(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{455:function(t,e,a){t.exports=a.p+"assets/img/pinata-api-key-permissions.4c36c2e8.png"},602:function(t,e,a){"use strict";a.r(e);var n=a(24),s=Object(n.a)({},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"mint-an-nft-with-ipfs"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mint-an-nft-with-ipfs"}},[t._v("#")]),t._v(" Mint an NFT with IPFS")]),t._v(" "),n("p",[t._v("Non-fungible tokens (NFTs) allow users to create and trade digital items with differing values. Go from nothing to creating a freshly-minted NFT token and storing it on IPFS with the help of services like "),n("a",{attrs:{href:"https://pinata.cloud",target:"_blank",rel:"noopener noreferrer"}},[t._v("Pinata"),n("OutboundLink")],1),t._v(" and "),n("a",{attrs:{href:"https://nft.storage",target:"_blank",rel:"noopener noreferrer"}},[t._v("nft.storage"),n("OutboundLink")],1),t._v(".")]),t._v(" "),n("p",[t._v("Since IPFS isn't a blockchain, we'll be leveraging the power of the Ethereum blockchain for this guide. However, the steps described here can just as easily be applied to other blockchains.")]),t._v(" "),n("h2",{attrs:{id:"a-short-introduction-to-nfts"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#a-short-introduction-to-nfts"}},[t._v("#")]),t._v(" A short introduction to NFTs")]),t._v(" "),n("p",[t._v("This guide doesn't go into the intricacies of NFTs, or even why they're important. This guide is solely to help you understand how to host NFTs on IPFS and how the process can be expanded to include other aspects of blockchain development.")]),t._v(" "),n("p",[t._v("That being said, we're going to cover the "),n("em",[t._v("very basics")]),t._v(" of NFTs here so that everyone's on the same page. If you're interested in a deeper dive in the world of NFT best practices and NFT development in general, head over to "),n("a",{attrs:{href:"https://nftschool.dev",target:"_blank",rel:"noopener noreferrer"}},[t._v("NFT School"),n("OutboundLink")],1),t._v(" for concept guides, tutorials, and how-tos.")]),t._v(" "),n("h3",{attrs:{id:"what-nfts-are-made-of"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#what-nfts-are-made-of"}},[t._v("#")]),t._v(" What NFTs are made of")]),t._v(" "),n("p",[t._v("There are a few key features that define an NFT, regardless of platform.")]),t._v(" "),n("p",[t._v("First, each token has a unique id that distinguishes it from all other tokens. This is in contrast to a fungible token like Ether "),n("code",[t._v("ETH")]),t._v(", which exists as a quantity attached to an account or wallet. There is no way to tell one "),n("code",[t._v("ETH")]),t._v(" from another. Because each NFT is unique, they're owned and traded individually, with the smart contract keeping track of who owns what.")]),t._v(" "),n("p",[t._v("Another key feature of an NFT is the ability to link to data that is stored outside of a smart contract. Storing or processing data outside of a smart-contract is known as being "),n("em",[t._v("off-chain")]),t._v(". Because data that's stored "),n("em",[t._v("on-chain")]),t._v(" needs to be processed, verified, and replicated across the entire blockchain network, it can be very expensive to store large amounts of data. This is a problem for many NFT use cases, especially tokens that represent digital collectibles or artwork, where storing the entire work could cost the equivalent of millions of US Dollars.")]),t._v(" "),n("h3",{attrs:{id:"how-ipfs-helps"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#how-ipfs-helps"}},[t._v("#")]),t._v(" How IPFS helps")]),t._v(" "),n("p",[t._v("When an NFT is created and linked to a digital file that lives on some other system, "),n("em",[t._v("how")]),t._v(" the data is linked is very important. There are a few reasons why traditional HTTP links aren't a great fit.")]),t._v(" "),n("p",[t._v("With an HTTP address like "),n("code",[t._v("https://cloud-bucket.provider.com/my-nft.jpeg")]),t._v(", anyone can fetch the contents of "),n("code",[t._v("my-nft.jpeg")]),t._v(", as long as the owner of the server pays their bills. However, there's no way to guarantee that the "),n("em",[t._v("contents")]),t._v(" of "),n("code",[t._v("my-nft.jpeg")]),t._v(" are the same as they were when the NFT was created. The server owner can easily replace "),n("code",[t._v("my-nft.jpeg")]),t._v(" with something completely different at any time, causing the NFT to change its meaning.")]),t._v(" "),n("p",[t._v("This problem was demonstrated by an artist who "),n("a",{attrs:{href:"https://cointelegraph.com/news/opensea-collector-pulls-the-rug-on-nfts-to-highlight-arbitrary-value",target:"_blank",rel:"noopener noreferrer"}},[n("em",[t._v("pulled the rug")]),n("OutboundLink")],1),t._v(" on NFTs he created by changing their images after they were minted and sold to others.")]),t._v(" "),n("p",[t._v("IPFS solves this problem thanks to "),n("RouterLink",{attrs:{to:"/concepts/content-addressing/"}},[t._v("Content Addressing")]),t._v(". Adding data to IPFS produces a content identifier (CID) that's directly derived from the data itself and links to the data in the IPFS network. Because a CID can only "),n("em",[t._v("ever")]),t._v(" refer to one piece of content, we know that nobody can replace or alter the content without breaking the link.")],1),t._v(" "),n("p",[t._v("Using the CID, anyone can fetch a copy of the data from the IPFS network as long as at least one copy exists on the network, even if the original provider has disappeared. This makes CIDs perfect for NFT storage. All we need to do is put the CID into an "),n("code",[t._v("ipfs://")]),t._v(" URI like "),n("code",[t._v("ipfs://bafybeidlkqhddsjrdue7y3dy27pu5d7ydyemcls4z24szlyik3we7vqvam/nft-image.png")]),t._v(", and we have an immutable link from the blockchain to the data for our token.")]),t._v(" "),n("p",[t._v("Of course, there may be some cases in which you do want to change the metadata for an NFT after it's been published. That's no problem! You'll just need to add support to your smart contract for updating the URI for a token after it's been issued. That will let you change the URI to a new IPFS URI while still leaving a record of the initial version in the blockchain's transaction history. This provides accountability and makes it clear to everyone what was changed, when, and by whom.")]),t._v(" "),n("h2",{attrs:{id:"minty"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#minty"}},[t._v("#")]),t._v(" Minty")]),t._v(" "),n("p",[t._v("To help explain how NFTs and IPFS can work together, we've created Minty - a simple command-line application to automatically "),n("em",[t._v("mint")]),t._v(" an NFT and pin it to IPFS using "),n("a",{attrs:{href:"https://estuary.tech/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Estuary"),n("OutboundLink")],1),t._v(", "),n("a",{attrs:{href:"https://nft.storage",target:"_blank",rel:"noopener noreferrer"}},[t._v("nft.storage"),n("OutboundLink")],1),t._v(", or "),n("a",{attrs:{href:"https://pinata.cloud",target:"_blank",rel:"noopener noreferrer"}},[t._v("Pinata"),n("OutboundLink")],1),t._v(".")]),t._v(" "),n("p",[t._v("Production NFT platforms are a fairly complex thing. As with any modern web application, there are lots of decisions to make surrounding the tech stack, user interface conventions, API design, and so on. Blockchain-enabled d-apps also need to interact with user wallets such as "),n("a",{attrs:{href:"https://metamask.io",target:"_blank",rel:"noopener noreferrer"}},[t._v("Metamask"),n("OutboundLink")],1),t._v(", further increasing their complexity.")]),t._v(" "),n("p",[t._v("Since Minty was written to demonstrate the concepts and process of minting IPFS-backed NFTs, we don't need to get caught up in all the details of modern d-app development. Instead, Minty is a simple command-line app written in Javascript.")]),t._v(" "),n("h3",{attrs:{id:"install-minty"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#install-minty"}},[t._v("#")]),t._v(" Install Minty")]),t._v(" "),n("p",[t._v("Let's get Minty installed so we can start playing around with NFTs! To install and run Minty, you must have NPM installed. Windows is not currently supported. Installation of Minty is fairly simple. Just download the GitHub repository, install the NPM dependencies, and start the local testnet environment.")]),t._v(" "),n("ol",[n("li",[n("p",[t._v("Clone "),n("a",{attrs:{href:"https://github.com/yusefnapora/minty",target:"_blank",rel:"noopener noreferrer"}},[t._v("the Minty repository"),n("OutboundLink")],1),t._v(" and move into the "),n("code",[t._v("minty")]),t._v(" directory:")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/yusefnapora/minty\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" minty\n")])])])]),t._v(" "),n("li",[n("p",[t._v("Install the NPM dependencies:")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v("\n")])])])]),t._v(" "),n("li",[n("p",[t._v("Add the "),n("code",[t._v("minty")]),t._v(" command to your "),n("code",[t._v("$PATH")]),t._v(". This step is optional, but it makes it easier to run Minty from anywhere on your computer:")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("link")]),t._v("\n")])])])]),t._v(" "),n("li",[n("p",[t._v("Run the "),n("code",[t._v("start-local-environment.sh")]),t._v(" script to start the local Ethereum testnet and IPFS daemon:")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("./start-local-environment.sh\n\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Compiling smart contract\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Compiling "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(" files with "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.7")]),t._v(".3\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n")])])]),n("p",[t._v("This command continues to run. All further commands must be entered in another terminal window.")])])]),t._v(" "),n("h3",{attrs:{id:"deploy-the-contract"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#deploy-the-contract"}},[t._v("#")]),t._v(" Deploy the contract")]),t._v(" "),n("p",[t._v("Before running any of the other "),n("code",[t._v("minty")]),t._v(" commands, you'll need to deploy an instance of the"),n("br"),t._v("\nsmart contract:")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("minty deploy\n\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" deploying contract "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" token Julep "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("JLP"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" to network "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"localhost"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" deployed contract "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" token Julep "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("JLP"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" to 0x5FbDB2315678afecb367f032d93F642f64180aa3 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("network: localhost"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Writing deployment info to minty-deployment.json\n")])])]),n("p",[t._v("This deploys to the network configured in "),n("code",[t._v("hardhat.config.js")]),t._v(", which is set to the "),n("code",[t._v("localhost")]),t._v(" network by default. If you get an error about not being able to reach the network, make sure you started the local development network with "),n("code",[t._v("./start-local-environment.sh")]),t._v(".")]),t._v(" "),n("p",[t._v("When this contract is deployed, the address and other information about the deployment are written to "),n("code",[t._v("minty-deployment.json")]),t._v(". This file must be present for subsequent commands to work.")]),t._v(" "),n("h3",{attrs:{id:"mint-an-nft"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mint-an-nft"}},[t._v("#")]),t._v(" Mint an NFT")]),t._v(" "),n("p",[t._v("Once you have the local Ethereum network and IPFS daemon running, minting an NFT is incredibly simple. Just specify what you want to "),n("em",[t._v("tokenize")]),t._v(", the name of the NFT, then add a description to tell users what the NFT is for.")]),t._v(" "),n("h4",{attrs:{id:"create-something-to-mint"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#create-something-to-mint"}},[t._v("#")]),t._v(" Create something to mint")]),t._v(" "),n("p",[t._v("First, let's create something to mint. NFTs have a huge range of use-cases, and you can mint whatever you want! For this example, we're going to create a ticket for a flight to the moon!")]),t._v(" "),n("ol",[n("li",[n("p",[t._v("Create a file called "),n("code",[t._v("flight-to-the-moon.txt")]),t._v(":")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("touch")]),t._v(" ~/flight-to-the-moon.txt\n")])])])]),t._v(" "),n("li",[n("p",[t._v("Open the file and enter some flight information:")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("THE INTERPLANETARY TRAVEL COMPANY\n---------------------------------\nDeparting: Cape Canaveral, Earth\nArriving: Base 314, The Moon\nBoarding time: 17:30 UTC\nSeat number: 1A\nBaggage allowance: 5kg \n")])])])]),t._v(" "),n("li",[n("p",[t._v("Save and close the file.")])])]),t._v(" "),n("h4",{attrs:{id:"mint-the-file"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mint-the-file"}},[t._v("#")]),t._v(" Mint the file")]),t._v(" "),n("p",[t._v("Now we're going to tokenize our ticket into an NFT. This process is often called "),n("em",[t._v("minting")]),t._v(".")]),t._v(" "),n("ol",[n("li",[n("p",[t._v("Call the "),n("code",[t._v("mint")]),t._v(" command and supply the file we want to mint, the name of our NFT, and a description:")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("minty mint ~/flight-to-the-moon.txt --name "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Moon Flight #1"')]),t._v(" --description "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"This ticket serves as proof-of-ownership of a first-class seat on a flight to the moon."')]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" ðŸŒ¿ Minted a new NFT:\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Token ID:              "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Metadata URI:          ipfs://bafybeic3ui4dj5dzsvqeiqbxjgg3fjmfmiinb3iyd2trixj2voe4jtefgq/metadata.json\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Metadata Gateway URL:  http://localhost:8080/ipfs/bafybeic3ui4dj5dzsvqeiqbxjgg3fjmfmiinb3iyd2trixj2voe4jtefgq/metadata.json\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Asset URI:             ipfs://bafybeihhii26gwp4w7b7w7d57nuuqeexau4pnnhrmckikaukjuei2dl3fq/flight-to-the-moon.txt\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Asset Gateway URL:     http://localhost:8080/ipfs/bafybeihhii26gwp4w7b7w7d57nuuqeexau4pnnhrmckikaukjuei2dl3fq/flight-to-the-moon.txt\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" NFT Metadata:\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"name"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Moon Flight #1"')]),t._v(",\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"description"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"This ticket serves as proof-of-ownership of a first-class seat on a flight to the moon."')]),t._v(",\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"image"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ipfs://bafybeihhii26gwp4w7b7w7d57nuuqeexau4pnnhrmckikaukjuei2dl3fq/flight-to-the-moon.txt"')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("The "),n("code",[t._v("minty mint")]),t._v(" command returns the id of the new token, some metadata containing the "),n("code",[t._v("name")]),t._v(" and "),n("code",[t._v("description")]),t._v(" we provided, and an IPFS URI to the file we used for our NFT asset. The "),n("code",[t._v("Metadata URI")]),t._v(" in the output above is the IPFS URI for the NFT Metadata JSON object that's stored on IPFS.")])])]),t._v(" "),n("p",[t._v("Great! You've created your NFT, but it's only available to other people as long as you have your IPFS node running. If you shut down your computer or you lose your internet connection, then no one else will be able to view your NFT! To get around this issue, you should pin it to a pinning service.")]),t._v(" "),n("h3",{attrs:{id:"pin-your-nft"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#pin-your-nft"}},[t._v("#")]),t._v(" Pin your NFT")]),t._v(" "),n("p",[t._v("To make the data highly available without needing to run a local IPFS daemon 24/7, you can request that a remote pinning service store a copy of your IPFS data on their IPFS nodes.")]),t._v(" "),n("p",[t._v("Any pinning service that supports the "),n("a",{attrs:{href:"https://ipfs.github.io/pinning-services-api-spec",target:"_blank",rel:"noopener noreferrer"}},[t._v("IPFS Remote Pinning API"),n("OutboundLink")],1),t._v(" can be used with Minty.")]),t._v(" "),n("p",[t._v("Below we'll show how to configure Minty to two different pinning services. Either one will work, so you'll only need to sign up to one service to try things out.")]),t._v(" "),n("h4",{attrs:{id:"option-1-pinata"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#option-1-pinata"}},[t._v("#")]),t._v(" Option 1: Pinata")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://pinata.cloud",target:"_blank",rel:"noopener noreferrer"}},[t._v("Pinata"),n("OutboundLink")],1),t._v(" is one of the oldest and most popular IPFS pinning services, and their free storage tier makes it easy to sign up and experiment.")]),t._v(" "),n("h5",{attrs:{id:"sign-up-to-pinata"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sign-up-to-pinata"}},[t._v("#")]),t._v(" Sign up to Pinata")]),t._v(" "),n("p",[t._v("To use Pinata to pin your data, you need to sign up for an account.")]),t._v(" "),n("ol",[n("li",[t._v("Head over to "),n("a",{attrs:{href:"https://pinata.cloud/",target:"_blank",rel:"noopener noreferrer"}},[t._v("pinata.cloud"),n("OutboundLink")],1),t._v(".")]),t._v(" "),n("li",[t._v("Click "),n("strong",[t._v("Sign up")]),t._v(" and use your email address to create an account.")])]),t._v(" "),n("p",[t._v("Pinata gives each user 1GB of free storage space, which is plenty for storing a few NFTs.")]),t._v(" "),n("h5",{attrs:{id:"get-an-api-key"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#get-an-api-key"}},[t._v("#")]),t._v(" Get an API key")]),t._v(" "),n("p",[t._v("You need to grab an API key from Pinata. Your API key allows Minty to interact with your Pinata account automatically.")]),t._v(" "),n("ol",[n("li",[n("p",[t._v("Log into Pinata and select "),n("strong",[t._v("API keys")]),t._v(" from the sidebar menu.")])]),t._v(" "),n("li",[n("p",[t._v("Click "),n("strong",[t._v("New Key")]),t._v(".")])]),t._v(" "),n("li",[n("p",[t._v("Expand the "),n("strong",[t._v("Pinning Services API")]),t._v(" drop-down and select all the options under "),n("strong",[t._v("Pins")]),t._v(":")]),t._v(" "),n("p",[n("img",{attrs:{src:a(455),alt:"The permissions options available to API keys in Pinata.",loading:"lazy"}})])]),t._v(" "),n("li",[n("p",[t._v("Pinata will give you an "),n("em",[t._v("API key")]),t._v(", and "),n("em",[t._v("API secret")]),t._v(", and a "),n("em",[t._v("JWT")]),t._v(":")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("API Key: 43537d17e88805007086\nAPI Secret: 492b24f041b9120cbf8e35a247fb686793231a3d89045f1046a4f5b2d2175082\nJWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySW5mb3JtYXRpb24iOnsiaWQiOiJiZDQ3NjM1Ny1lYWRhLTQ1ZDUtYTVmNS1mM2EwZjRmZGZmYmEiLCJlbWFpbCI6InRhaWxzbm93QHByb3Rvbm1haWwuY29tIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsInBpbl9wb2xpY3kiOnsicmVnaW9ucyI6W3siaWQiOiJGUkExIiwiZGVzaXJlZFJlcGxpY2F0aW9uQ291bnQiOjF9XSwidmVyc2lvbiI6MX0sIm1mYV9lbmFibGVkIjpmYWxzZX0sImF1dGhlbnRpY2F0aW9uVHlwZSI6InNjb3BlZEtleSIsInNjb3BlZEtleUtleSI6IjQzNTM3ZDE3ZTg4ODA1MDA3MDg2Iiwic2NvcGVkS2V5U2VjcmV0IjoiNDkyYjI0ZjA0MWI5MTIwY2JmOGUzNWEyNDdmYjY4Njc5MzIzMWEzZDg5MDQ1ZjEwNDZhNGY1YjJkMjE3NTA4MiIsImlhdCI6MTYxNjAxMzExNX0.xDV9-cPwDIQInuiB0M--XiJ8dQwwDYMch4gJbc6ogXs\n")])])]),n("p",[t._v("We just need the "),n("code",[t._v("JWT")]),t._v(". You can ignore the "),n("code",[t._v("API Key")]),t._v(" and "),n("code",[t._v("API Secret")]),t._v(" for now.")])]),t._v(" "),n("li",[n("p",[t._v("Copy the "),n("code",[t._v("config/pinata.env.example")]),t._v(" file to "),n("code",[t._v("config/.env")]),t._v(":")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("cp")]),t._v(" config/pinata.env.example config/.env\n")])])])]),t._v(" "),n("li",[n("p",[t._v("Inside "),n("code",[t._v("config/.env")]),t._v(" add your JWT token to the "),n("code",[t._v("PINNING_SERVICE_KEY")]),t._v(" line "),n("em",[t._v("between")]),t._v(" the double quotes "),n("code",[t._v('"')]),t._v(":")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("PINNING_SERVICE_KEY")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySW5mb3JtYXRpb24iOnsia..."')]),t._v("\n")])])])]),t._v(" "),n("li",[n("p",[t._v("Minty can now connect to Pinata and pin NFT data to your account!")])])]),t._v(" "),n("h4",{attrs:{id:"option-2-nft-storage"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#option-2-nft-storage"}},[t._v("#")]),t._v(" Option 2: nft.storage")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://nft.storage",target:"_blank",rel:"noopener noreferrer"}},[t._v("nft.storage"),n("OutboundLink")],1),t._v(" is a new service offered by Protocol Labs to store public NFT data. It's currently a free public beta, so it's super easy to sign up and try it out.")]),t._v(" "),n("h5",{attrs:{id:"sign-up-to-nft-storage"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sign-up-to-nft-storage"}},[t._v("#")]),t._v(" Sign up to nft.storage")]),t._v(" "),n("p",[t._v("To use nft.storage for your NFT data, you'll need to sign up for an account. You'll also need a GitHub account for logging in, if you don't already have one.")]),t._v(" "),n("ol",[n("li",[t._v("Head over to "),n("a",{attrs:{href:"https://nft.storage",target:"_blank",rel:"noopener noreferrer"}},[t._v("nft.storage"),n("OutboundLink")],1),t._v(".")]),t._v(" "),n("li",[t._v("Click "),n("strong",[t._v("Register")]),t._v(" and use your GitHub account to register.")])]),t._v(" "),n("h5",{attrs:{id:"get-an-api-key-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#get-an-api-key-2"}},[t._v("#")]),t._v(" Get an API Key")]),t._v(" "),n("p",[t._v("You need to copy an API key from the nft.storage site and put it where Minty can find it.")]),t._v(" "),n("ol",[n("li",[t._v("Log into nft.storage and select "),n("strong",[t._v("Manage API Keys")]),t._v(" from the top menu.")]),t._v(" "),n("li",[t._v("Click "),n("strong",[t._v("New Key")]),t._v(".")]),t._v(" "),n("li",[t._v("The new key should show up in the list. Copy the key to your clipboard. It should be a long string starting with "),n("code",[t._v("ey...")]),t._v(".")])]),t._v(" "),n("p",[t._v("We need to put the key into a file where Minty can find it.")]),t._v(" "),n("ol",[n("li",[n("p",[t._v("Copy the "),n("code",[t._v("config/nft.storage.env.example")]),t._v(" file to "),n("code",[t._v("config/.env")]),t._v(":")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("cp")]),t._v(" config/nft.storage.env.example config/.env\n")])])])]),t._v(" "),n("li",[n("p",[t._v("Inside "),n("code",[t._v("config/.env")]),t._v(" add your API key to the "),n("code",[t._v("PINNING_SERVICE_KEY")]),t._v(" line "),n("em",[t._v("between")]),t._v(" the double quotes "),n("code",[t._v('"')]),t._v(":")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("PINNING_SERVICE_KEY")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySW5mb3JtYXRpb24iOnsia..."')]),t._v("\n")])])])]),t._v(" "),n("li",[n("p",[t._v("Minty can now connect to nft.storage and pin NFT data to your account!")])])]),t._v(" "),n("h3",{attrs:{id:"deploying-to-a-testnet"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#deploying-to-a-testnet"}},[t._v("#")]),t._v(" Deploying to a testnet")]),t._v(" "),n("p",[t._v("Take a look at the "),n("a",{attrs:{href:"https://hardhat.org/config/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Hardhat configuration docs"),n("OutboundLink")],1),t._v(" to learn how to configure a JSON-RPC node and deploy this contract to a testnet. Once you've added a new network to the Hardhat configuration, you can use it by setting the "),n("code",[t._v("HARDHAT_NETWORK")]),t._v(" environment variable to the name of the new network when you run "),n("code",[t._v("minty")]),t._v(" commands. Alternatively, you can change the "),n("code",[t._v("defaultNetwork")]),t._v(" in "),n("code",[t._v("hardhat.config.js")]),t._v(" to always prefer the new network.")]),t._v(" "),n("p",[t._v("Deploying this contract to the Ethereum mainnet is a bad idea since the contract itself lacks any access control. See the "),n("a",{attrs:{href:"https://docs.openzeppelin.com/contracts/3.x/access-control",target:"_blank",rel:"noopener noreferrer"}},[t._v("Open Zeppelin article"),n("OutboundLink")],1),t._v(" about what access control is and why it's important to have.")]),t._v(" "),n("h2",{attrs:{id:"how-minty-works"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#how-minty-works"}},[t._v("#")]),t._v(" How Minty works")]),t._v(" "),n("p",[t._v("So we minted an NFT, added it to an Ethereum blockchain, and hosted it on IPFS. Now we're going to dive into "),n("em",[t._v("exactly")]),t._v(" what the contract does and why. We're also going to explore the IPFS side of things and how the NFT itself is stored.")]),t._v(" "),n("h3",{attrs:{id:"the-minty-smart-contract"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#the-minty-smart-contract"}},[t._v("#")]),t._v(" The Minty smart-contract")]),t._v(" "),n("p",[t._v("Minty uses a smart-contract written in "),n("a",{attrs:{href:"https://soliditylang.org",target:"_blank",rel:"noopener noreferrer"}},[t._v("Solidity"),n("OutboundLink")],1),t._v(", the most popular language for Ethereum development. The contract implements the "),n("a",{attrs:{href:"https://eips.ethereum.org/EIPS/eip-721",target:"_blank",rel:"noopener noreferrer"}},[t._v("ERC-721 Ethereum NFT standard"),n("OutboundLink")],1),t._v(", by virtue of inheriting from the very convenient and fully featured "),n("a",{attrs:{href:"https://docs.openzeppelin.com/contracts/3.x/api/token/erc721#ERC721",target:"_blank",rel:"noopener noreferrer"}},[t._v("OpenZeppelin ERC721 base contract"),n("OutboundLink")],1),t._v(".")]),t._v(" "),n("p",[t._v("Because the OpenZeppelin base contract provides so much of the core functionality, the Minty contract is quite simple:")]),t._v(" "),n("div",{staticClass:"language-solidity extra-class"},[n("pre",{pre:!0,attrs:{class:"language-solidity"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("pragma")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("solidity")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^")]),n("span",{pre:!0,attrs:{class:"token version number"}},[t._v("0.7.0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hardhat/console.sol"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@openzeppelin/contracts/token/ERC721/ERC721.sol"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@openzeppelin/contracts/utils/Counters.sol"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("contract")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Minty")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("is")]),t._v(" ERC721 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Counters")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" Counters"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Counter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    Counters"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Counter "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" _tokenIds"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("constructor")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("memory")]),t._v(" tokenName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("memory")]),t._v(" symbol"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("ERC721")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tokenName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" symbol"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("_setBaseURI")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ipfs://"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("mintToken")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("address")]),t._v(" owner"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("memory")]),t._v(" metadataURI"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("returns")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint256")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        _tokenIds"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("increment")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint256")]),t._v(" id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" _tokenIds"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("current")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("_safeMint")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("owner"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("_setTokenURI")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" metadataURI"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("If you read the "),n("a",{attrs:{href:"https://docs.openzeppelin.com/contracts/3.x/erc721",target:"_blank",rel:"noopener noreferrer"}},[t._v("OpenZeppelin ERC721 guide"),n("OutboundLink")],1),t._v(", you'll see that the Minty contract is extremely similar. The "),n("code",[t._v("mintToken")]),t._v(" function simply increments a counter to issue token ids, and it uses the "),n("code",[t._v("_setTokenURI")]),t._v(" function provided by the base contract to associate the metadata URI with the new token id.")]),t._v(" "),n("p",[t._v("One thing to notice is that we set the base URI prefix to "),n("code",[t._v("ipfs://")]),t._v(" in the constructor. When we set a metadata URI for each token in the "),n("code",[t._v("mintToken")]),t._v(" function, we don't need to store the prefix since the base contract's "),n("code",[t._v("tokenURI")]),t._v(" accessor function will apply it to each token's URI.")]),t._v(" "),n("p",[t._v("It's important to note that this contract is "),n("strong",[t._v("not production-ready")]),t._v(". It doesn't include any "),n("a",{attrs:{href:"https://docs.openzeppelin.com/contracts/3.x/access-control",target:"_blank",rel:"noopener noreferrer"}},[t._v("access controls"),n("OutboundLink")],1),t._v(" that limit which accounts are allowed to call the "),n("code",[t._v("mintToken")]),t._v(" function. If you decide to develop a production platform based on Minty, please explore the access control patterns that are available and consider which should apply to your platform's access model.")]),t._v(" "),n("h4",{attrs:{id:"deploying-the-contract"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#deploying-the-contract"}},[t._v("#")]),t._v(" Deploying the Contract")]),t._v(" "),n("p",[t._v("Before you can mint new NFTs, you need to deploy the contract to a blockchain network. Minty uses "),n("a",{attrs:{href:"https://hardhat.org",target:"_blank",rel:"noopener noreferrer"}},[t._v("HardHat"),n("OutboundLink")],1),t._v(" to manage contract deployment. By default, Minty deploys to an instance of the "),n("a",{attrs:{href:"https://hardhat.org/hardhat-network",target:"_blank",rel:"noopener noreferrer"}},[t._v("HardHat development network"),n("OutboundLink")],1),t._v(" that's been "),n("a",{attrs:{href:"https://hardhat.org/hardhat-network/#connecting-to-hardhat-network-from-wallets-and-other-software",target:"_blank",rel:"noopener noreferrer"}},[t._v("configured to run on your machine's localhost network"),n("OutboundLink")],1),t._v(".")]),t._v(" "),n("p",[t._v("It's also possible to deploy the contract to an "),n("a",{attrs:{href:"https://ethereum.org/en/developers/docs/networks/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Ethereum test network"),n("OutboundLink")],1),t._v(" by editing the "),n("code",[t._v("hardhat.config.js")]),t._v(" file in the minty repo. See the "),n("a",{attrs:{href:"https://hardhat.org/config/#json-rpc-based-networks",target:"_blank",rel:"noopener noreferrer"}},[t._v("HardHat documentation"),n("OutboundLink")],1),t._v(" to learn how to configure HardHat to deploy to a node connected to a testnet, either running locally or hosted by a provider such as "),n("a",{attrs:{href:"https://infura.io",target:"_blank",rel:"noopener noreferrer"}},[t._v("Infura"),n("OutboundLink")],1),t._v(". Because deployment consumes "),n("code",[t._v("ETH")]),t._v(" as gas, you'll need to obtain some test "),n("code",[t._v("ETH")]),t._v(" for your chosen network and configure hardhat to use the correct wallet.")]),t._v(" "),n("h4",{attrs:{id:"calling-the-minttoken-smart-contract-function"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#calling-the-minttoken-smart-contract-function"}},[t._v("#")]),t._v(" Calling the "),n("code",[t._v("mintToken")]),t._v(" smart-contract function")]),t._v(" "),n("p",[t._v("Let's look at how Minty's JavaScript code interacts with the smart contract's "),n("code",[t._v("mintToken")]),t._v(" function. This happens in the "),n("code",[t._v("mintToken")]),t._v(" method of the "),n("code",[t._v("Minty")]),t._v(" class:")]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("mintToken")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("ownerAddress"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" metadataURI")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// The smart contract adds an ipfs:// prefix to all URIs, ")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// so make sure to remove it so it doesn't get added twice")]),t._v("\n  metadataURI "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("stripIpfsUriPrefix")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("metadataURI"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Call the mintToken smart contract function to issue a new token")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// to the given address. This returns a transaction object, but the ")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// transaction hasn't been confirmed yet, so it doesn't have our token id.")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" tx "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("contract"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("mintToken")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ownerAddress"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" metadataURI"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// The OpenZeppelin base ERC721 contract emits a Transfer event ")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// when a token is issued. tx.wait() will wait until a block containing ")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// our transaction has been mined and confirmed. The transaction receipt ")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// contains events emitted while processing the transaction.")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" receipt "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" tx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("wait")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" event "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("of")]),t._v(" receipt"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("events"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("event "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Transfer'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ignoring unknown event type '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("continue")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("args"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tokenId"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Error")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'unable to get token id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("As you can see, calling the smart contract function is mostly like calling a normal JavaScript function, thanks to the "),n("a",{attrs:{href:"https://docs.ethers.io/v5/",target:"_blank",rel:"noopener noreferrer"}},[t._v("ethers.js smart contract library"),n("OutboundLink")],1),t._v(". However, since the "),n("code",[t._v("mintToken")]),t._v(" function modifies the blockchain's state, it can't return a value right away. This is because the function call creates an ethereum transaction, and there's no way to know for sure that the block containing the transaction will actually be mined and incorporated into the blockchain. For example, there may not be enough gas to pay for the transaction.")]),t._v(" "),n("p",[t._v("To get the token id for our new NFT, we need to call "),n("code",[t._v("tx.wait()")]),t._v(", which waits until the transaction has been confirmed. The token id is wrapped inside a "),n("code",[t._v("Transfer")]),t._v(" event, which is emitted by the base contract when a new token is created or transferred to a new owner. By inspecting the transaction receipt returned from "),n("code",[t._v("tx.wait()")]),t._v(", we can pull the token id out of the "),n("code",[t._v("Transfer")]),t._v(" event.")]),t._v(" "),n("h3",{attrs:{id:"storing-nft-data-on-ipfs"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#storing-nft-data-on-ipfs"}},[t._v("#")]),t._v(" Storing NFT data on IPFS")]),t._v(" "),n("p",[t._v("The smart contract's "),n("code",[t._v("mintToken")]),t._v(" function expects an IPFS metadata URI, which should resolve to a JSON object describing the NFT. Minty uses the metadata schema described in "),n("a",{attrs:{href:"https://eips.ethereum.org/EIPS/eip-721",target:"_blank",rel:"noopener noreferrer"}},[t._v("EIP-721"),n("OutboundLink")],1),t._v(", which supports JSON objects like this:")]),t._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A name for this NFT"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"description"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"An in-depth description of the NFT"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"image"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ipfs://bafybeidlkqhddsjrdue7y3dy27pu5d7ydyemcls4z24szlyik3we7vqvam/nft-image.png"')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("The "),n("code",[t._v("image")]),t._v(" field contains a URI that resolves to the NFT image data we want to associate with the token. This field doesn't necessarily have to be an image; it can be any file-type.")]),t._v(" "),n("p",[t._v("To get the metadata URI for our smart contract, we first add the image data to IPFS to get an IPFS "),n("RouterLink",{attrs:{to:"/concepts/content-addressing/"}},[t._v("CID")]),t._v(" and use the CID to build an "),n("code",[t._v("ipfs://")]),t._v(" URI. Then we create a JSON object containing the image URI along with the user-provided "),n("code",[t._v("name")]),t._v(" and "),n("code",[t._v("description")]),t._v(" fields. Finally, we add the JSON data to IPFS to create the metadata "),n("code",[t._v("ipfs://")]),t._v(" URI and feed that into the smart contract.")],1),t._v(" "),n("p",[t._v("Minty's "),n("code",[t._v("createNFTFromAssetData")]),t._v(" method is responsible for this process, with help from a few utility functions:")]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createNFTFromAssetData")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("content"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// add the asset to IPFS")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" filePath "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("path "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'asset.bin'")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" basename "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("  path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("basename")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("filePath"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// When you add an object to IPFS with a directory prefix in its path,")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// IPFS will create a directory structure for you. This is nice, because")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// it gives us URIs with descriptive filenames in them e.g.")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 'ipfs://bafybeihhii26gwp4w7b7w7d57nuuqeexau4pnnhrmckikaukjuei2dl3fq/cat-pic.png' vs")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 'ipfs://bafybeihhii26gwp4w7b7w7d57nuuqeexau4pnnhrmckikaukjuei2dl3fq'")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ipfsPath "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/nft/'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" basename\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("cid")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" assetCid "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ipfs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("path")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" ipfsPath"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" content "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// make the NFT metadata JSON")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" assetURI "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("ensureIpfsUriPrefix")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("assetCid"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" basename\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" metadata "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("makeNFTMetadata")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("assetURI"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// add the metadata to IPFS")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("cid")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" metadataCid "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ipfs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n    "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("path")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/nft/metadata.json'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n    "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("content")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("stringify")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("metadata"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" metadataURI "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("ensureIpfsUriPrefix")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("metadataCid"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/metadata.json'")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// get the address of the token owner from options, ")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// or use the default signing address if no owner is given")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" ownerAddress "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("owner\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("ownerAddress"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    ownerAddress "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("defaultOwnerAddress")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// mint a new token referencing the metadata URI")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" tokenId "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("mintToken")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ownerAddress"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" metadataURI"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// format and return the results")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    tokenId"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    metadata"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    assetURI"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    metadataURI"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("assetGatewayURL")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("makeGatewayURL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("assetURI"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("metadataGatewayURL")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("makeGatewayURL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("metadataURI"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("We're adding our data to IPFS using a "),n("code",[t._v("path")]),t._v(" argument with a directory structure, e.g., "),n("code",[t._v("/nft/metadata.json")]),t._v(" instead of just "),n("code",[t._v("metadata.json")]),t._v(". This isn't strictly necessary, but it gives us more descriptive URIs that include human-readable filenames. On the downside, the metadata URI requires a bit more space on-chain since it includes the "),n("code",[t._v("/metadata.json")]),t._v(" portion as well as the IPFS CID. In a production environment where bytes cost money, you may want to modify the smart contract to only store the CID portion and automatically append the filename before returning the URI or simply store metadata without a directory wrapper.")]),t._v(" "),n("h3",{attrs:{id:"retrieving-nft-data"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#retrieving-nft-data"}},[t._v("#")]),t._v(" Retrieving NFT data")]),t._v(" "),n("p",[t._v("To view the metadata for an existing NFT, we call the smart contract's "),n("code",[t._v("tokenURI")]),t._v(" function, then fetch the JSON data from IPFS and parse it into an object. This happens in "),n("code",[t._v("getNFTMetadata")]),t._v(":")]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getNFTMetadata")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("tokenId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" metadataURI "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("contract"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("tokenURI")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tokenId"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" metadata "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getIPFSJSON")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("metadataURI"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("metadata"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" metadataURI"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("See the "),n("a",{attrs:{href:"https://github.com/yusefnapora/minty/blob/39a3e79e01b4776372a08fa352c8fe508ffa9845/src/minty.js#L193-L212",target:"_blank",rel:"noopener noreferrer"}},[n("code",[t._v("getNFT")]),t._v(" method"),n("OutboundLink")],1),t._v(" for an example that also fetches the asset data from IPFS by resolving the URI in the metadata's "),n("code",[t._v("image")]),t._v(" field.")]),t._v(" "),n("p",[t._v("The "),n("code",[t._v("getNFT")]),t._v(" method is used by the "),n("code",[t._v("minty")]),t._v(" command-line app to view a token using the "),n("code",[t._v("minty show <token-id>")]),t._v(" command:")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('minty show 14\n\nToken ID:              14\nOwner Address:         0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266\nMetadata URI:          ipfs://bafybeieeomufuwkwf7sbhyo7yiifaiknm7cht5tc3vakn25vbvazyasp3u/metadata.json\nMetadata Gateway URL:  http://localhost:8080/ipfs/bafybeieeomufuwkwf7sbhyo7yiifaiknm7cht5tc3vakn25vbvazyasp3u/metadata.json\nAsset URI:             ipfs://bafybeifszd4wbkeekwzwitvgijrw6zkzijxutm4kdumkxnc6677drtslni/ipfs-logo-768px.png\nAsset Gateway URL:     http://localhost:8080/ipfs/bafybeifszd4wbkeekwzwitvgijrw6zkzijxutm4kdumkxnc6677drtslni/ipfs-logo-768px.png\nNFT Metadata:\n{\n  "name": "The IPFS Logo",\n  "description": "The IPFS logo (768px, png)",\n  "image": "ipfs://bafybeifszd4wbkeekwzwitvgijrw6zkzijxutm4kdumkxnc6677drtslni/ipfs-logo-768px.png"\n}\n')])])]),n("p",[t._v("If you have an IPFS-enabled browser like "),n("a",{attrs:{href:"https://brave.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("Brave"),n("OutboundLink")],1),t._v(" installed, you can paste the "),n("code",[t._v("Asset URI")]),t._v(" or "),n("code",[t._v("Metadata URI")]),t._v(" into the address bar directly and see the content served up by your local IPFS node. If your browser doesn't support IPFS natively, you can use the "),n("code",[t._v("Asset Gateway URL")]),t._v(" or "),n("code",[t._v("Metadata Gateway URL")]),t._v(" instead, which will serve the data from a local HTTP gateway.")]),t._v(" "),n("p",[t._v("You can also try using a public gateway like the one at "),n("a",{attrs:{href:"https://ipfs.io",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://ipfs.io"),n("OutboundLink")],1),t._v(". To do so, replace "),n("code",[t._v("http://localhost:8080")]),t._v(" in the gateway URL with "),n("code",[t._v("https://ipfs.io")]),t._v(". However, you may notice that this takes a little longer than requesting the same file from your local node. This is because the public gateway doesn't have a copy of the data yet, so it has to look up the CID on the IPFS network and fetch it from your local IPFS node.")]),t._v(" "),n("h3",{attrs:{id:"pinning-nft-data-to-a-remote-service"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#pinning-nft-data-to-a-remote-service"}},[t._v("#")]),t._v(" Pinning NFT data to a remote service")]),t._v(" "),n("p",[t._v("When you add data to IPFS, it first gets added to your local IPFS node, which advertises the CID of the data to the IPFS network. This lets anyone request the data by looking up the CID and connecting to your node directly. Once they've done so, their IPFS node will hold onto a copy temporarily, which helps speed up access to the data if another node requests it. However, by default, these extra copies will eventually expire so that people running IPFS don't use up all of their storage space.")]),t._v(" "),n("p",[t._v("When minting NFTs, we generally want our data to be at least as "),n("em",[t._v("durable")]),t._v(" as the blockchain platform the token was minted on, and we want it to be available all the time and across the globe.")]),t._v(" "),n("p",[t._v("As an NFT minting platform, you can certainly run your own IPFS infrastructure to ensure the storage of your user's NFT assets. See the "),n("a",{attrs:{href:"../../install/server-infrastructure"}},[t._v("Server Infrastructure documentation")]),t._v(" to learn how an IPFS cluster can provide highly-available IPFS storage and retrieval that scales to a large volume of data and requests.")]),t._v(" "),n("p",[t._v("As an alternative to running your own infrastructure, you can arrange for an IPFS Pinning Service to "),n("em",[t._v("pin")]),t._v(" your data to their IPFS nodes, which are already tuned for high volume and reliability.")]),t._v(" "),n("p",[t._v("Minty uses the "),n("a",{attrs:{href:"https://ipfs.github.io/pinning-services-api-spec/",target:"_blank",rel:"noopener noreferrer"}},[t._v("IPFS Pinning Service API"),n("OutboundLink")],1),t._v(" to request that a remote pinning service store that data for a given token, using the "),n("code",[t._v("minty pin <token-id>")]),t._v(" command.")]),t._v(" "),n("p",[t._v("The default Minty configuration expects to find an environment variable name "),n("code",[t._v("PINATA_API_TOKEN")]),t._v(" containing the JWT access token for your Pinata account. Once you have a token, you can create a file called "),n("code",[t._v("config/default.env")]),t._v(" in the Minty repo and make it look similar to this:")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("PINATA_API_TOKEN")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Paste JWT token here"')]),t._v("\n")])])]),n("p",[t._v("Now when you run "),n("code",[t._v("minty pin")]),t._v(", Minty should have everything it needs to connect to Pinata.")]),t._v(" "),n("p",[t._v("If you decide to use a different pinning service, change the configuration entry for Pinata in the "),n("code",[t._v("config/default.js")]),t._v(" file in the Minty repo.")]),t._v(" "),n("p",[t._v("Here's an example of running "),n("code",[t._v("minty pin <token-id>")]),t._v(":")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("minty pin 2\nPinning asset data (ipfs://bafybeifszd4wbkeekwzwitvgijrw6zkzijxutm4kdumkxnc6677drtslni/ipfs-logo-768px.png) for token id 2....\nPinning metadata (ipfs://bafybeieeomufuwkwf7sbhyo7yiifaiknm7cht5tc3vakn25vbvazyasp3u/metadata.json) for token id 2...\nðŸŒ¿ Pinned all data for token id 2\n")])])]),n("p",[t._v("This first looks up the token metadata and then sends a request to the pinning service to pin the asset CID and the metadata CID.")]),t._v(" "),n("p",[t._v("In the code, this happens in the "),n("code",[t._v("pinTokenData")]),t._v(" method:")]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("pinTokenData")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("tokenId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("metadata"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" metadataURI"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getNFTMetadata")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tokenId"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("image")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" assetURI"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" metadata\n  \n  console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("Pinning asset data (")]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("assetURI"),n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v(") for token id ")]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("tokenId"),n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("....")]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("pin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("assetURI"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("Pinning metadata (")]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("metadataURI"),n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v(") for token id ")]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("tokenId"),n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("...")]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("pin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("metadataURI"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("assetURI"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" metadataURI"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("The actual pin request is sent in the "),n("code",[t._v("pin")]),t._v(" method:")]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("pin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("cidOrURI")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" cid "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("extractCID")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cidOrURI"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Make sure IPFS is set up to use our preferred pinning service.")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("_configurePinningService")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// Check if we\'ve already pinned this CID to avoid a "duplicate pin" error.')]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" pinned "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("isPinned")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cid"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pinned"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Ask the remote service to pin the content.")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Behind the scenes, this will cause the pinning service to connect to our local IPFS node")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// and fetch the data using Bitswap, IPFS's transfer protocol.")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ipfs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pin"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("remote"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cid"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("service")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" config"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pinningService"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("Because the pinning service API expects a CID and we may have a full "),n("code",[t._v("ipfs://")]),t._v(" URI, we use a little helper called "),n("code",[t._v("extractCID")]),t._v(" to pull out the CID portion.")]),t._v(" "),n("p",[t._v("Then, we call "),n("code",[t._v("_configurePinningService")]),t._v(" to tell IPFS to use the remote service if it hasn't already been configured.")]),t._v(" "),n("p",[t._v("We do a check to see if we've already pinned this CID since the API will return an error if we try to pin content that's already been pinned. Alternatively, you could just try to pin and check to see if the returned error is for duplicate content.")]),t._v(" "),n("p",[t._v("Finally, we call "),n("code",[t._v("ipfs.pin.remote.add")]),t._v(", passing in the name of the pinning service. When the pinning service receives the request, it will try to connect to our local IPFS node, and our local node will also try to connect to their IPFS nodes. Once they're connected, the service will fetch the CIDs we asked it to pin and store the data on their infrastructure.")]),t._v(" "),n("p",[t._v("To verify that the data was pinned, you can run "),n("code",[t._v("ipfs pin remote ls --service=pinata")]),t._v(" to see a list of the content you've pinned to Pinata. If you don't already have a copy of IPFS installed on your machine, you can use the one bundled with Minty by running "),n("code",[t._v("npx go-ipfs pin remote ls --service=pinata")]),t._v(" instead. Alternatively, you can log into the "),n("a",{attrs:{href:"https://pinata.cloud",target:"_blank",rel:"noopener noreferrer"}},[t._v("Pinata website"),n("OutboundLink")],1),t._v(" and use the "),n("strong",[t._v("Pin explorer")]),t._v(" to view your data.")]),t._v(" "),n("h2",{attrs:{id:"next-steps"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#next-steps"}},[t._v("#")]),t._v(" Next steps")]),t._v(" "),n("p",[t._v("That was quite a lot to cover! We've seen how to add assets to IPFS and create NFT metadata, how to link our metadata to a new NFT on Ethereum, and how to pin our data with a remote provider for persistence.")]),t._v(" "),n("p",[t._v("At this point, you might be wondering how to take these techniques and use them to build a production NFT minting platform. Of course, there are many decisions involved in any new product or marketplace, so we can't think of everything here. But there are a few places where Minty is clearly not "),n("em",[t._v("production ready")]),t._v(", and by looking at them, we can get a good idea of what technical work might be involved.")]),t._v(" "),n("p",[t._v("As a command-line app, "),n("code",[t._v("minty")]),t._v(" is a pretty big departure from the rich, interactive web applications that power NFT minting platforms. If you want to build a web platform based on the techniques shown in Minty, you will either need to expose Minty's functionality via an HTTP API or go the "),n("em",[t._v("fully decentralized")]),t._v(" route and interact with the NFT contract directly in the user's Ethereum-enabled web browser. The good news is that all of the concepts we've learned so far are applicable to either environment.")]),t._v(" "),n("p",[t._v("Since Minty currently runs on Node.js, it's straightforward to add an API server using one of the many Node HTTP frameworks like "),n("a",{attrs:{href:"https://expressjs.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("Express"),n("OutboundLink")],1),t._v(" or "),n("a",{attrs:{href:"https://koajs.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("Koa"),n("OutboundLink")],1),t._v(". However, it can be difficult to allow users to sign Ethereum transactions with their own private keys if the code is running on a backend server. As such, you may want to put some blockchain logic in the frontend so that users can use "),n("a",{attrs:{href:"https://metamask.io",target:"_blank",rel:"noopener noreferrer"}},[t._v("MetaMask"),n("OutboundLink")],1),t._v(" or a similar wallet to authorize token transfers.")]),t._v(" "),n("p",[t._v("Work is also underway to "),n("a",{attrs:{href:"https://github.com/ipfs/js-ipfs/pull/3588",target:"_blank",rel:"noopener noreferrer"}},[t._v("support the remote pinning service API"),n("OutboundLink")],1),t._v(" in "),n("code",[t._v("js-ipfs")]),t._v(", so soon you'll be able to run the entire process in the user's browser using an embedded IPFS node.")]),t._v(" "),n("p",[t._v("If you're building a d-app without a backend server today and just can't wait, you could also use an HTTP API provided by a pinning service to send and pin content using traditional HTTP requests instead of embedding js-ipfs into your d-app. See "),n("a",{attrs:{href:"https://pinata.cloud/documentation",target:"_blank",rel:"noopener noreferrer"}},[t._v("Pinata's documentation"),n("OutboundLink")],1),t._v(" for an example. This makes your d-app code a little less generic since it's tied to one provider's API, but it may be a good way to get started. Doing everything in the browser also means you'll need to carefully manage the API tokens for the pinning services you support, perhaps by allowing users to add their own credentials and storing the tokens in the browser's local storage.")]),t._v(" "),n("p",[t._v("Finally, please consider that the Minty smart contract is intentionally very simple and is not tailored to the needs of a production platform. In particular, it lacks "),n("a",{attrs:{href:"https://docs.openzeppelin.com/contracts/3.x/access-control",target:"_blank",rel:"noopener noreferrer"}},[t._v("access controls"),n("OutboundLink")],1),t._v(" and is not "),n("a",{attrs:{href:"https://docs.openzeppelin.com/contracts/3.x/upgradeable",target:"_blank",rel:"noopener noreferrer"}},[t._v("upgradable"),n("OutboundLink")],1),t._v(" without re-deploying the contract. Chances are you'll want your contract to include features that are unique to your platform as well, beyond the base ERC-721 functionality.")]),t._v(" "),n("p",[t._v("Thanks for following along! We can't wait to see what you'll build.")])])}),[],!1,null,null,null);e.default=s.exports}}]);Ý¹