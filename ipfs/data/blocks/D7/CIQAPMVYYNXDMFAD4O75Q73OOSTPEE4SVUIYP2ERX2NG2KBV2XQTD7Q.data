
–—Œ—(window.webpackJsonp=window.webpackJsonp||[]).push([[75],{605:function(e,s,t){"use strict";t.r(s);var a=t(24),o=Object(a.a)({},(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"move-an-ipfs-installation"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#move-an-ipfs-installation"}},[e._v("#")]),e._v(" Move an IPFS installation")]),e._v(" "),t("p",[e._v("This page walks through how to move your IPFS installation from one system to another. This process is cross-platform compatible and is especially useful for readers who are changing operating systems. The process is to grab the "),t("code",[e._v(".ipfs")]),e._v(" folder from the "),t("em",[e._v("home")]),e._v(" directory of the "),t("em",[e._v("donor")]),e._v(" system, and copy it over to "),t("em",[e._v("home")]),e._v(" directory on the receiving system.")]),e._v(" "),t("p",[e._v("This process is not a backup procedure; do not treat it as such. Many things can go wrong with this process, most of which relate to "),t("em",[e._v("peer IDs")]),e._v(". Since we are duplicating an "),t("code",[e._v(".ipfs")]),e._v(" installation folder, both IPFS peers have the same peer ID. This issue is ok as long as you delete the old "),t("em",[e._v("donor")]),e._v(" installation once the copy is complete. Never start two peers with the same peer IDs on different places, as they will misbehave.")]),e._v(" "),t("h2",{attrs:{id:"move-installation"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#move-installation"}},[e._v("#")]),e._v(" Move installation")]),e._v(" "),t("p",[e._v("The easiest way to move your IPFS installation is to grab the "),t("code",[e._v(".ipfs")]),e._v(" folder, and move it to another destination.")]),e._v(" "),t("h3",{attrs:{id:"linux-and-macos"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#linux-and-macos"}},[e._v("#")]),e._v(" Linux and macOS")]),e._v(" "),t("ol",[t("li",[t("p",[e._v("Stop any IPFS daemons, services, or applications from running.")])]),e._v(" "),t("li",[t("p",[e._v("In a terminal, move to where your IPFS repository is stored, likely your "),t("em",[e._v("home")]),e._v(" folder:")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("cd")]),e._v(" ~/\n")])])])]),e._v(" "),t("li",[t("p",[e._v("Make a copy of the "),t("code",[e._v(".ipfs")]),e._v(" directory:")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("cp")]),e._v(" --recursive --verbose "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v(" -z "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("$(")]),e._v("cp --help "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("grep")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"\\-\\-reflink"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("head")]),e._v(" -n1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("||")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("echo")]),e._v(" -n "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"--reflink=auto"')]),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v(")")])]),e._v(" .ipfs ipfs-backup\n\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'.ipfs'")]),e._v(" -"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'ipfs-backup'")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'.ipfs/datastore_spec'")]),e._v(" -"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'ipfs-backup/data'")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\n")])])])])]),e._v(" "),t("p",[e._v("The above command checks whether the current operating system supports the "),t("code",[e._v("cp --reflink")]),e._v(" command. If it does, like in most Linux operating systems, then this command will use the "),t("code",[e._v("--reflink")]),e._v(" argument when calling the "),t("code",[e._v("cp")]),e._v(" program. If the operating system does not support the "),t("code",[e._v("--reflink")]),e._v(" argument, like MacOS, then it will not use that argument.")]),e._v(" "),t("ol",[t("li",[e._v("You now have a copy of your IPFS repository within the "),t("code",[e._v("ipfs-backup")]),e._v(" folder.")])]),e._v(" "),t("h3",{attrs:{id:"windows"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#windows"}},[e._v("#")]),e._v(" Windows")]),e._v(" "),t("ol",[t("li",[e._v("Stop any IPFS daemons, services, or applications from running.")]),e._v(" "),t("li",[e._v("Open the file explorer and go to "),t("strong",[e._v("C:")]),e._v(" â†’ "),t("strong",[e._v("Users")]),e._v(" â†’ "),t("strong",[e._v("Your Username")]),e._v(".")]),e._v(" "),t("li",[e._v("Select the "),t("strong",[e._v("View")]),e._v(" tab at the top of the file explorer window, and check the "),t("strong",[e._v("Hidden items")]),e._v(" checkbox.")]),e._v(" "),t("li",[e._v("Find the "),t("code",[e._v(".ipfs")]),e._v(" within your user's "),t("em",[e._v("home")]),e._v(" folder. This is usually "),t("code",[e._v("C:\\Users\\Your Username\\.ipfs")]),e._v(".")]),e._v(" "),t("li",[e._v("Copy this folder to somewhere convenient like the "),t("code",[e._v("Desktop")]),e._v(" and rename it to "),t("code",[e._v("ipfs-backup")]),e._v(".")])]),e._v(" "),t("h2",{attrs:{id:"restore-installation"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#restore-installation"}},[e._v("#")]),e._v(" Restore installation")]),e._v(" "),t("p",[e._v("Once you have a backup of your IPFS repository in "),t("code",[e._v("ipfs-backup")]),e._v(", you can move it to the computer you want to restore to. Once there, you can restore your IPFS repository.")]),e._v(" "),t("h3",{attrs:{id:"linux-and-macos-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#linux-and-macos-2"}},[e._v("#")]),e._v(" Linux and macOS")]),e._v(" "),t("ol",[t("li",[t("p",[e._v("Stop any IPFS daemons, services, or applications from running.")])]),e._v(" "),t("li",[t("p",[e._v("In a terminal, move to where your IPFS repository is stored, likely your "),t("em",[e._v("home")]),e._v(" folder:")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("cd")]),e._v(" ~/\n")])])])]),e._v(" "),t("li",[t("p",[e._v("Move your current IPFS repository to another folder. If something goes wrong you can restore your installation from here:")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("mv")]),e._v(" .ipfs ipfs-old\n")])])])]),e._v(" "),t("li",[t("p",[e._v("Move your backup IPFS repository to "),t("code",[e._v(".ipfs")]),e._v(":")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("mv")]),e._v(" ipfs-backup .ipfs\n")])])])]),e._v(" "),t("li",[t("p",[e._v("Start an IPFS daemon:")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("ipfs daemon\n\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" Initializing daemon"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" go-ipfs version: "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0.5")]),e._v(".0-dev-a22dc826c\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" Repo version: "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("7")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" Daemon is ready\n")])])])]),e._v(" "),t("li",[t("p",[e._v("If everything is working fine, you can delete your old IPFS repository:")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("rm")]),e._v(" -rf .ipfs-old\n")])])])])]),e._v(" "),t("h3",{attrs:{id:"windows-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#windows-2"}},[e._v("#")]),e._v(" Windows")]),e._v(" "),t("ol",[t("li",[e._v("If restoring to the IPFS Desktop application, open the application at least once before attempting to restore anything.")]),e._v(" "),t("li",[e._v("Stop any IPFS daemons, services, or applications from running.")]),e._v(" "),t("li",[e._v("Open the file explorer and go to "),t("code",[e._v("C:\\Users\\Your Username")]),e._v(".")]),e._v(" "),t("li",[e._v("Select the "),t("strong",[e._v("View")]),e._v(" tab at the top of the file explorer window, and check the "),t("strong",[e._v("Hidden items")]),e._v(" checkbox.")]),e._v(" "),t("li",[e._v("Find the "),t("code",[e._v(".ipfs")]),e._v(" within your user's "),t("em",[e._v("home")]),e._v(" folder. The full address is usually something like "),t("code",[e._v("C:\\Users\\Your Username\\.ipfs")]),e._v(".")]),e._v(" "),t("li",[e._v("Rename the "),t("code",[e._v(".ipfs")]),e._v(" folder to "),t("code",[e._v("ipfs-old")]),e._v(". We can restore from "),t("code",[e._v("ipfs-old")]),e._v(" if anything goes wrong.")]),e._v(" "),t("li",[e._v("Copy your "),t("code",[e._v("ipfs-backup")]),e._v(" IPFS repository into your user's "),t("em",[e._v("home")]),e._v(" folder and rename it to "),t("code",[e._v(".ipfs")]),e._v(".")]),e._v(" "),t("li",[e._v("Open the IPFS Desktop application or run "),t("code",[e._v("ipfs daemon")]),e._v(" with Powershell. Everything should start, and your IPFS repository should restore normally.")])]),e._v(" "),t("h2",{attrs:{id:"windows-subsystem-for-linux"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#windows-subsystem-for-linux"}},[e._v("#")]),e._v(" Windows Subsystem for Linux")]),e._v(" "),t("p",[e._v("If you have IPFS installed in the Windows Subsystem for Linux, you can move your IPFS repository from Linux into your Windows environment. This process overwrites the IPFS repository in Windows.")]),e._v(" "),t("ol",[t("li",[t("p",[e._v("On Windows, open the IPFS Desktop application or run an "),t("code",[e._v("ipfs daemon")]),e._v(". Do this at least once.")])]),e._v(" "),t("li",[t("p",[e._v("Stop any IPFS daemons, services, or applications from running in your Linux and Windows environments.")])]),e._v(" "),t("li",[t("p",[e._v("Copy your Linux IPFS repository to Windows. This process overwrites the IPFS repository in Windows:")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("cp")]),e._v(" --recursive --verbose ~/.ipfs /mnt/c/Users/Your Username/\n")])])])]),e._v(" "),t("li",[t("p",[e._v("On Windows, open the IPFS Desktop application or run an "),t("code",[e._v("ipfs daemon")]),e._v(". Everything should open successfully.")])])]),e._v(" "),t("h2",{attrs:{id:"troubleshooting"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#troubleshooting"}},[e._v("#")]),e._v(" Troubleshooting")]),e._v(" "),t("p",[e._v("Here are some common issues you might run into when moving your IPFS installation.")]),e._v(" "),t("h3",{attrs:{id:"linux-and-macos-3"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#linux-and-macos-3"}},[e._v("#")]),e._v(" Linux and macOS")]),e._v(" "),t("h4",{attrs:{id:"ipfs-daemon-doesn-t-run-successfully"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ipfs-daemon-doesn-t-run-successfully"}},[e._v("#")]),e._v(" IPFS daemon doesn't run successfully")]),e._v(" "),t("p",[e._v("If "),t("code",[e._v("ipfs daemon")]),e._v(" doesn't run successfully then you can restore your old IPFS repository, assuming you made a copy:")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("mv")]),e._v(" .ipfs ipfs-backup-broken\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("mv")]),e._v(" .ipfs-old .ipfs\n")])])]),t("p",[e._v("Running "),t("code",[e._v("ipfs daemon")]),e._v(" now loads your old IPFS repository. Try repeating the backup and restore steps. Make sure to stop any IPFS services, daemons, or applications when backing up and restoring an IPFS repository.")]),e._v(" "),t("h4",{attrs:{id:"some-data-from-the-old-installation-is-missing-on-the-new-one"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#some-data-from-the-old-installation-is-missing-on-the-new-one"}},[e._v("#")]),e._v(" Some data from the old installation is missing on the new one")]),e._v(" "),t("p",[e._v("If you've previously run some "),t("code",[e._v("ipfs")]),e._v(" commands with "),t("code",[e._v("sudo")]),e._v(", for example, "),t("code",[e._v("sudo ipfs get $someCID")]),e._v(", the "),t("code",[e._v("ipfs")]),e._v(" command may have created a new IPFS repository for the "),t("code",[e._v("root")]),e._v(" user, separate from the one for your user account.")]),e._v(" "),t("p",[e._v("If you have "),t("code",[e._v("root")]),e._v(" / "),t("code",[e._v("sudo")]),e._v(" access to the old system, check to see if the directory "),t("code",[e._v("/root/.ipfs")]),e._v(" exists. If so, make a backup of the "),t("code",[e._v("/root/.ipfs")]),e._v(" directory, as described above.")]),e._v(" "),t("p",[e._v("If you want to consolidate the two repositories, you can export the IPFS objects from one repository to a set of CAR files and import them into a different repository.")]),e._v(" "),t("p",[e._v("Below is a small bash snippet to export all local IPFS objects to a set of files in a directory called "),t("code",[e._v("car_export")]),e._v(". These commands should be run as the user who owns the repository you want to export, and the ipfs daemon should be running.")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("mkdir")]),e._v(" -p car_export\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("cd")]),e._v(" car_export\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("cids")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$(")]),e._v("ipfs refs "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("local")]),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v(")")])]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("for")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token for-or-select variable"}},[e._v("cid")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("in")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$cids")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("do")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("echo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"exporting '),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$cid")]),e._v('"')]),e._v("\n  ipfs dag "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$cid")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$cid")]),e._v(".car\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("done")]),e._v("\n")])])]),t("p",[e._v("You should then be able to import those files into a new IPFS installation using a command like this:")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("cd")]),e._v(" car_export\nipfs dag "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("import")]),e._v(" *.car\n")])])]),t("h3",{attrs:{id:"windows-3"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#windows-3"}},[e._v("#")]),e._v(" Windows")]),e._v(" "),t("h4",{attrs:{id:"ipfs-desktop-has-an-error"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ipfs-desktop-has-an-error"}},[e._v("#")]),e._v(" IPFS Desktop has an error")]),e._v(" "),t("p",[e._v("Make sure to open the IPFS Desktop application at least once before attempting to move any IPFS repositories. The IPFS Desktop relies upon another directory called "),t("code",[e._v(".ipfs-desktop")]),e._v(". The migration sometimes fails if this folder does not exist.")]),e._v(" "),t("h4",{attrs:{id:"ipfs-desktop-won-t-open"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ipfs-desktop-won-t-open"}},[e._v("#")]),e._v(" IPFS Desktop won't open")]),e._v(" "),t("p",[e._v("In your user's "),t("em",[e._v("home")]),e._v(" folder, rename "),t("code",[e._v(".ipfs")]),e._v(" and "),t("code",[e._v(".ipfs-desktop")]),e._v(" to "),t("code",[e._v("ipfs-broken")]),e._v(" and "),t("code",[e._v("ipfs-desktop-broken")]),e._v(" respectively. Open the IPFS Desktop application; this creates new "),t("code",[e._v(".ipfs")]),e._v(" and "),t("code",[e._v(".ipfs-desktop")]),e._v(" folders. Close the IPFS desktop application and replace "),t("code",[e._v(".ipfs")]),e._v(" with "),t("code",[e._v("ipfs-broken")]),e._v(". If the IPFS desktop application opens, then you now know that the original "),t("code",[e._v(".ipfs-desktop")]),e._v(" folder was the issue. If the IPFS desktop application doesn't open, then the original "),t("code",[e._v(".ipfs")]),e._v(" folder may be the issue. If both original folders are causing issues, you may have a corrupted database. If this is the case, post your issue on the "),t("a",{attrs:{href:"https://discuss.ipfs.io/",target:"_blank",rel:"noopener noreferrer"}},[e._v("IPFS forums"),t("OutboundLink")],1),e._v(".")])])}),[],!1,null,null,null);s.default=o.exports}}]);Œ—