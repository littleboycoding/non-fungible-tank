
ë,ã,(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{595:function(e,t,s){"use strict";s.r(t);var a=s(24),r=Object(a.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"support-for-x-ipfs-path-headers-in-ipfs-companion"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#support-for-x-ipfs-path-headers-in-ipfs-companion"}},[e._v("#")]),e._v(" Support for "),s("code",[e._v("x-ipfs-path")]),e._v(" headers in IPFS Companion")]),e._v(" "),s("p",[e._v("IPFS Companion can redirect traditional HTTP requests to IPFS if the "),s("code",[e._v("x-ipfs-path")]),e._v(" response header is provided.")]),e._v(" "),s("p",[e._v("Additionally, some browser vendors like "),s("a",{attrs:{href:"https://brave.com/ipfs-support/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Brave"),s("OutboundLink")],1),e._v(" may display an "),s("strong",[e._v("Open using IPFS")]),e._v(" button on the address bar when this header is returned for the root document in the current tab.")]),e._v(" "),s("h2",{attrs:{id:"overview"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#overview"}},[e._v("#")]),e._v(" Overview")]),e._v(" "),s("p",[e._v("IPFS HTTP gateways can return an "),s("code",[e._v("x-ipfs-path")]),e._v(" header with each response. The value of the header is the IPFS path of the returned payload.")]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" -sI https://en.wikipedia-on-ipfs.org "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("grep")]),e._v(" x-ipfs-path\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" x-ipfs-path: /ipns/en.wikipedia-on-ipfs.org/\n")])])]),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" -sI https://dweb.link/ipfs/bafybeigdyrzt5sfp7udm7hu76uh7y26nf3efuylqabf3oclgtqy55fbzdi "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("grep")]),e._v(" x-ipfs-path\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" x-ipfs-path: /ipfs/bafybeigdyrzt5sfp7udm7hu76uh7y26nf3efuylqabf3oclgtqy55fbzdi\n")])])]),s("p",[e._v("The WebExtension API "),s("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/onHeadersReceived",target:"_blank",rel:"noopener noreferrer"}},[e._v("onHeadersReceived"),s("OutboundLink")],1),e._v(" can cancel and redirect the HTTP request as soon as the response headers arrive. This means the client can drop the initial request, avoiding duplicate downloads of the content.")]),e._v(" "),s("p",[e._v("Detection of the "),s("code",[e._v("x-ipfs-path")]),e._v(" header can be disabled in the "),s("em",[e._v("Preferences")]),e._v(" screen (but is enabled by default).")]),e._v(" "),s("h2",{attrs:{id:"use-cases"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#use-cases"}},[e._v("#")]),e._v(" Use cases")]),e._v(" "),s("h3",{attrs:{id:"fallback-for-edge-cases-where-the-ipfs-path-is-not-present-in-the-url"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#fallback-for-edge-cases-where-the-ipfs-path-is-not-present-in-the-url"}},[e._v("#")]),e._v(" Fallback for edge cases where the IPFS path is not present in the URL")]),e._v(" "),s("p",[e._v("A website owner can have the HTTP gateway behind a reverse-proxy, but configure it to expose "),s("code",[e._v("/ipfs/<cid>/")]),e._v(" under "),s("code",[e._v("/")]),e._v(", in which case path-based IPFS detection by IPFS Companion (see "),s("a",{attrs:{href:"https://developer.mozilla.org/en-US/Add-ons/WebExtensions/API/webRequest/onBeforeRequest",target:"_blank",rel:"noopener noreferrer"}},[e._v("onBeforeRequest"),s("OutboundLink")],1),e._v(") won't work.")]),e._v(" "),s("p",[e._v("Thanks to the "),s("code",[e._v("x-ipfs-path")]),e._v(" header, we have a reliable fallback for these configurations.")]),e._v(" "),s("h3",{attrs:{id:"hinting-dnslink-lookups"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#hinting-dnslink-lookups"}},[e._v("#")]),e._v(" Hinting DNSLink lookups")]),e._v(" "),s("p",[e._v("The presence of an "),s("code",[e._v("x-ipfs-path")]),e._v(" header is a clear indicator that a website uses IPFS.")]),e._v(" "),s("p",[e._v('There is a "best-effort" '),s("RouterLink",{attrs:{to:"/how-to/dnslink-companion/"}},[e._v("DNSLink policy")]),e._v(" enabled by default to execute blocking DNS TXT lookups for FQDNs that returned the header.")],1),e._v(" "),s("p",[e._v("Note that "),s("code",[e._v("x-ipfs-path")]),e._v(" values starting with "),s("code",[e._v("/ipns/")]),e._v(" will be ignored if "),s("RouterLink",{attrs:{to:"/how-to/dnslink-companion/"}},[e._v("DNSLink policy")]),e._v(' is "off" or the DNS TXT record is missing.')],1),e._v(" "),s("h3",{attrs:{id:"other-resources"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#other-resources"}},[e._v("#")]),e._v(" Other resources")]),e._v(" "),s("ul",[s("li",[e._v("An overview of the "),s("code",[e._v("onBeforeRequest")]),e._v(" and "),s("code",[e._v("onHeadersReceived")]),e._v(" listeners can be found in the "),s("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest",target:"_blank",rel:"noopener noreferrer"}},[e._v("WebExtensions API: webRequest"),s("OutboundLink")],1),e._v(" documentation")])])])}),[],!1,null,null,null);t.default=r.exports}}]);ã,